{% extends '_vbase.html' %}


{% load staticfiles %}

{% block stylesheet %}
<link rel="stylesheet" href="{% static 'virvo/wro/spectrum.css' %}" >
<link rel="stylesheet" href="{% static '/ol/v3.20.1-dist/ol.css' %}"/>

{% endblock %}

{% block main_content %}

        <div class="row">
          <div class="col-md-12">
            <div class="col-md-2" style="padding-right: 0px; padding-left: 0px;">
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h3 class="panel-title fwb">DMA分区</h3>
                  <div class="actions pull-right listActions">
                    <i class="fa fa-chevron-down"></i>
                  </div>
                </div>
                <div class="panel-body" style="padding: 0px;">
                  <div class="form-group" style="margin-top: 15px;">
                    <div class="col-md-12">
                      <input id="search_condition" name="search" class="form-control" style="margin-bottom: 10px;" type="text" placeholder="请输入组织名称" />
                    </div>
                  </div>
                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12  panelCarBg" style="padding: 0px;height:80%!important">
                    <ul id="treeDemo" class="ztreee" style="overflow:auto;height:500px!important"></ul>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="col-md-2" style="padding-right: 0px; padding-left:0px;"></div>
            <!-- 基本信息 -->
            <div class="col-md-10" style="padding-right: 0px; padding-left: 10px;">
              <div class="panel panel-default">
                <div class="panel-heading" style="cursor:pointer;" id="stretch" >
                  <h3 class="panel-title fwb">基本信息<span class="caret"></span></h3>
                  <div class="actions pull-right listActions">
                    <i class="fa chevron-up"  id="stretch-chevron" ></i>
                  </div>
                </div>
                <div class="panel-body fixed-table-body"  id="stretch-body">
                  <!--工具面板-->
                  <div class="ToolPanel">
                    <form id="baseinfoForm" role="form" action="/dmam/district/dmabaseinfo/" method="post" class="form-horizontal">{% csrf_token %}
                      
                      <input value="{{ current_dma_no }}" id="current_dma_no" type="hidden"  />
                      <input value="{{ current_dma_name }}" id="current_dma_name" type="hidden"  />

                      <div class="modal-body" id="baseinfoParameters">
                        <div class="form-group">
                          <label class="col-md-2 control-label">分区编号：</label>
                          <div class="col-md-2">
                            <input id="id_dma_no" name="dma_no" class="form-control" readonly="" type="text">
                          </div>
                          <label class="col-md-2 control-label">管道材质：</label>
                          <div class="col-md-2">
                            <input id="id_pipe_texture" name="pipe_texture" class="form-control" readonly="" type="text">
                          </div>
                          <label class="col-md-2 control-label">IFC参数：</label>
                          <div class="col-md-2">
                            <input id="id_ifc" name="ifc" class="form-control" readonly="" type="text">
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="col-md-2 control-label">所属组织：</label>
                          <div class="has-feedback col-md-2">
                            <input name="belongto"
                                class="form-control" id="zTreeOrganSelEdit" placeholder="请选择所属企业" readonly="readonly" style="background-color: #fafafa; cursor: pointer;"
                                type="text" value="{{ form.belongto.value }}" />
                                <span id="zTreeOrganSelSpan" class="fa fa-chevron-down form-control-feedback" aria-hidden="true"></span>
                            <div id="zTreeContentEdit" class="ztreeModelBox" style="top:36px!important">
                                <ul id="ztreeOrganEdit" class="ztree"></ul>
                            </div>
                        </div>
                          <label class="col-md-2 control-label">管道总长度（m）：</label>
                          <div class="col-md-2">
                            <input id="id_pipe_length" name="pipe_length" class="form-control" readonly="" type="text">
                          </div>
                          <label class="col-md-2 control-label">AZNP：</label>
                          <div class="col-md-2">
                            <input id="id_aznp" name="aznp" class="form-control" readonly="" type="text">
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="col-md-2 control-label">服务人口：</label>
                          <div class="col-md-2">
                            <input id="id_pepoles_num" name="pepoles_num" class="form-control" readonly="" type="text">
                          </div>
                          <label class="col-md-2 control-label">管道连接总数（个）：</label>
                          <div class="col-md-2">
                            <input id="id_pipe_links" name="pipe_links" class="form-control" readonly="" type="text">
                          </div>
                          <label class="col-md-2 control-label">正常夜间用水量：</label>
                          <div class="col-md-2">
                            <input id="id_night_use" name="night_use" class="form-control" readonly="" type="text">
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="col-md-2 control-label">服务面积：</label>
                          <div class="col-md-2">
                            <input id="id_acreage" name="acreage" class="form-control" readonly="" type="text">
                          </div>
                          <label class="col-md-2 control-label">管道最长服务年限（年）：</label>
                          <div class="col-md-2">
                            <input id="id_pipe_years" name="pipe_years" class="form-control" readonly="" type="text">
                          </div>
                          <label class="col-md-2 control-label">产销差目标值：</label>
                          <div class="col-md-2">
                            <input id="id_cxc_value" name="cxc_value" class="form-control" readonly="" type="text">
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="col-md-2 control-label">用户数量：</label>
                          <div class="col-md-2">
                            <input id="id_user_num" name="user_num" class="form-control" readonly="" type="text">
                          </div>
                          <label class="col-md-2 control-label">私人拥有水管长度（m）：</label>
                          <div class="col-md-2">
                            <input id="id_pipe_private" name="pipe_private" class="form-control" readonly="" type="text">
                          </div>

                          <!-- <div class="col-md-2"></div> -->
                          <div class="col-md-4" >
                            <button type="button" id="baseinfomMdify"  style="margin-left: 140px;" class="btn btn-primary ">修改</button>
                            <button type="button" id="baseinfoCommit" class="btn btn-primary ">提交</button>
                            <button type="button" id="baseinfoRestore"  class="btn btn-primary ">恢复</button>
                          </div>

                        </div>
                      </div>
                          
                    </form>

                  </div>
                  
                </div>
              </div>
            </div>

              


            <div class="col-md-2" style="padding-right: 0px; padding-left:0px;"></div>
            <div class="col-md-10 " style="padding-right: 0px; padding-left:10px;">
              <div class="panel panel-default">
                <div class="panel-heading" id="stretch2" >
                  <h3 class="panel-title fwb">站点管理</h3>
                  <div class="actions pull-right listActions">
                    <i class="fa chevron-down"  id="stretch2-chevron" ></i>
                  </div>
                </div>
                <div class="panel-body fixed-table-body"  id="stretch2-body">
                  
                  <div class="ToolPanel">
                    <div class="row">
                      <input value="{{ current_dma_pk }}" id="current_dma_pk" type="hidden"  />
                      <button type="button" href="" id="assignstation" data-toggle="modal" data-target="#fenceBind"  class="btn  btn-primary " style="margin-left: 100px;">站点管理</button>
                    

                    <div class="columns btn-group pull-right refShowRight">
                      <button id="refreshTable" class="btn btn-default"
                        type="button" name="refresh" title="刷新">
                        <i class="glyphicon glyphicon-refresh icon-refresh"></i>
                      </button>
                      <div class="keep-open btn-group" title="定制显示列">
                        <button id="customizeColumns" type="button"
                          class="btn btn-default dropdown-toggle"
                          data-toggle="dropdown">
                          <i class="glyphicon glyphicon-th icon-th"></i> <span
                            class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu" id="Ul-menu-text">
                        </ul>
                      </div>
                    </div>
                    </div>
                  </div>
                  <table id="dataTable"
                    class="table table-striped table-bordered table-hover checkTable"
                    cellspacing="0" width="100%">
                    <thead>
                      <tr>
                        <th>序号</th>
                        <th>站点名称</th>
                        <th>类型</th>
                        <th>表具类型</th>
                        <th>表具编号</th>
                        <th>口径</th>
                        <th>所属组织</th>
                        <th>安装日期</th>
                        
                      </tr>
                    </thead>
                  </table>
                </div>
              </div>
            </div>

            <!--  -->
            <div style="cursor: default; display: hide;" class="modal fade in" id="fenceBind" aria-hidden="false" data-backdrop="static" role="dialog" >
                <div class="modal-dialog modal-lg" role="document" style="width: 80%; max-height: 697px; height: auto;">
                  <div class="modal-content"></div>
                </div>
            </div>
            <!--  -->


            <div class="col-md-2" style="padding-right: 0px; padding-left:0px;"></div>
            <div class="col-md-10 " style="padding-right: 0px; padding-left:10px;">
              <div class="panel panel-default">
                <div class="panel-heading" id="stretch3" >
                  <h3 class="panel-title fwb">区域图形配置</h3>
                  <div class="actions pull-right listActions">
                    <i class="fa chevron-down"  id="stretch3-chevron" ></i>
                  </div>
                </div>
                <div class="panel-body fixed-table-body"  id="stretch3-body">
                  <div class="row">
                    
                    <div class="col-md-2">
                      
                      <div><button type="button" id="btnFillColor" class="btn btn-primary " >蒙层颜色</button><input type='text' id="fillColor" style="display: none;" />
                      </div>
                      <div><button type="button" id="btnstrokColor" class="btn btn-primary " >边框颜色</button><input type='text'  id="strokeColor" />
                      </div>
                      
                      
                      
                      <!-- <div class="example">
                        <input type="text" value="blanchedalmond" name="toggle" id="toggle" style="display: none;"><div class="sp-replacer sp-light"><div class="sp-preview"><div class="sp-preview-inner" style="background-color: rgb(255, 235, 205);"></div></div><div class="sp-dd">▼</div></div>
                        <button id="btn-toggle">Toggle</button>
                      </div> -->
                    </div>
                    <div class="col-md-4">
                      <div style="text-align: left;">图形预览：</div>
                      <div id="mapContainer" style="height: 400px;border: 1px solid grey;margin-left: -50px;"></div>
                    </div>
                    <div class="col-md-2">
                      <button id="statsticData" type="button" class="btn btn-primary search-btn" style="margin-top: 180px;" name="1" onclick=""><i class="glyphicon glyphicon-search"></i>  统计</button>
                      </div>
                    
                    <div class="col-md-4">
                      <div>区域统计信息：</div>

                      <table id="tb_zone_static" class="table table-bordered" style="height: 400px;text-align: center;margin-left: -50px;">
                      <thead >
                        <tr >
                          <th style="width: 150px;text-align: center;">名称</th>
                          <th style="text-align: center;">结果</th>
                          
                        </tr>
        
                      </thead>
                     
                      <tr>
                        <td>管线长度（m）</td>
                        <td id="res_pipe_length"> </td>
                        
                      </tr>
                      <tr>
                        <td>水表井（个）</td>
                        <td id="res_meter_num"> </td>
                        
                      </tr>
                      <tr>
                        <td>阀门井（个）</td>
                        <td id="res_valv"> </td>
                        
                      </tr>
                      <tr>
                        <td>消防栓（个）</td>
                        <td id="res_well"> </td>
                        
                      </tr>
                      <tr>
                        <td>阀门（个）</td>
                        <td id="res_valv"> </td>
                        
                      </tr>
                      <tr>
                        <td>接头（个）</td>
                        <td id="res_joint"> </td>
                        
                      </tr>
                        
                     
                   </table>
                    </div>
                  </div>
                  
                  
                </div>
              </div>
            </div>
            
            
                        
 
            
          </div>  
          
        </div>

{% endblock %}




{% block javascript %}
<script>
  var publicEditSuccess = "成功提交";
  var publicEditError = "提交不成功";
  var userGroupDeleteConfirm = "\u60A8\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u7EC4\u7EC7\u5417";
  var systemError = "\u5BF9\u4E0D\u8D77\uFF0C\u7CFB\u7EDF\u8D70\u4E22\u4E86\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458";
  var userNodeNameNull = "\u8282\u70B9\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A";
  var userSupermanagerDeleteTip = "\u4E0D\u80FD\u5220\u9664\u8D85\u7EA7\u7BA1\u7406\u5458";
  var userDeleteChooseNull = "\u8BF7\u81F3\u5C11\u52FE\u9009\u4E00\u9879";
  var selectItem = "\u4E0D\u80FD\u56E0\u4E3A\u4F60\u957F\u7684\u597D\u770B\uFF0C\u5C31\u53EF\u4EE5\u4EC0\u4E48\u90FD\u4E0D\u9009\u5427\uFF0C\u600E\u4E48\u4E5F\u8981\u9009\u4E00\u4E2A\u5427:)";
  var publicAddSuccess="\u6DFB\u52A0\u6210\u529F";
  var publicDelete="\u5220\u6389\u5C31\u6CA1\u5566\uFF0C\u8BF7\u8C28\u614E\u4E0B\u624B";
  var publicError="\u7CFB\u7EDF\u7684\u60C5\u7EEA\u4E0D\u7A33\u5B9A\uFF0C\u5E76\u5411\u4F60\u6254\u4E86\u4E00\u4E2A\u9519\u8BEF~";
  var publicDeleteSuccess="\u5220\u9664\u6210\u529F";
  var publicPerverseData="\u8BF7\u8F93\u5165\u5408\u6CD5\u7684\u5185\u5BB9";
  var publicSize20="\u957F\u5EA6\u4E0D\u8D85\u8FC720\u4F4D";
  var publicSize30="\u957F\u5EA6\u4E0D\u8D85\u8FC730\u4F4D";
  var publicMinSize2Length="\u957F\u5EA6\u4E0D\u80FD\u5C0F\u4E8E2\u4F4D";
  var userQualificationNull="\u8FD0\u8425\u8D44\u8D28\u7C7B\u522B\u4E0D\u80FD\u4E3A\u7A7A";
  var userQualificationExists="\u8BE5\u8FD0\u8425\u8D44\u8D28\u7C7B\u522B\u5DF2\u7ECF\u5B58\u5728,\u8BF7\u52FF\u91CD\u590D\u6DFB\u52A0";
</script>

<!-- <script src="http://webapi.amap.com/maps?v=1.4.6&key=f034871b532a7bfb2d93f18e915b322c&plugin=AMap.DistrictSearch&plugin=AMap.MouseTool"></script> -->
<!-- <script src="http://webapi.amap.com/maps?v=1.4.6&key=f034871b532a7bfb2d93f18e915b322c&plugin=AMap.DistrictSearch&plugin=AMap.PolyEditor"></script> -->
<script type="text/javascript" src="{% static '/ol/v3.20.1-dist/ol-debug.js' %}"></script>

<script src="{% static 'virvo/resources/js/zTree/js/ztreeSearch.js' %}"></script>

<script src="{% static 'virvo/wro/dmamanager.js' %}"></script>
<script src="{% static 'virvo/resources/js/sendAjax.js' %}"></script>
<script src="{% static 'virvo/wro/spectrum.js' %}"></script>

<script>
  
$("#btnFillColor").click(function() {
  console.log("btn-toggle clicked")
    $("#fillColor").spectrum("toggle");
    return false;
});

$("#btnstrokColor").click(function() {
  console.log("btn-toggle clicked")
    $("#strokeColor").spectrum("toggle");
    return false;
});

</script>

{% endblock %}
